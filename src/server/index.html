<script src="/socket.io/socket.io.js"></script>
<script>
var socket = io();

const url = window.location.hash.slice(1);

const split1 = url.split(']');

const key_event = new KeyboardEvent('EnterEvent');

function gaming()
{
	socket.emit('new_tetrimino');
}

function press_enter(event)
{
	console.log(event.code);
	if (event.code == "Enter")
	{
		window.removeEventListener("keydown", press_enter);
		socket.emit('start');
		gaming();
	}
}

socket.on("info_response", (ir) =>
		{
			if (ir === 'host')
			{
				window.addEventListener("keydown", press_enter);
			}
			else if (ir == 'player2')
			{
				console.log('player2');
				socket.on('start', gaming);
			}
			else if (ir == 'full')
				console.log('cannot join the game is full');
			else if (ir == 'started')
				console.log('cannot join the game has already started');
		});


if (split1[1] == '' && split1[2] == undefined)
{
	const split2 = split1[0].split('[');
	if (split2[2] == undefined && split2[0] && split2[1])
		socket.emit('info', split2[0], split2[1]);
	else
		console.log("error");
}
else
	console.log("Error ");

if (window.location.hash.slice(1))
{
	console.log(`'${window.location.hash.slice(1)}'`);
}

socket.on('won', () => {console.log('I WON')});
socket.on('spectre', (s) => {console.log('spectre', s)});
socket.on('malus', (m) => {console.log('malus', m)});
socket.on('tetrimino', (data) => {
	console.log(data);
	//	socket.emit('new_tetrimino', 2);
});


console.log(socket.id);

socket.on('datatest', (data) => {console.log(data)});

function hello(){
	socket.emit('start');
	socket.emit('new_tetrimino', [0,1,2,3,4,5,6,7,8,9], 3);
	socket.emit('dead');
};

</script>


<button onclick="hello()"> yo</div>
